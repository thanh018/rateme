<% layout('layout2') %>

<div id="wrapper">
  <div id="page-content-wrapper">
    <% include ../partials/navbar %>
    <div class="container">
      <h4 class="mainTitle text-center">Companies</h4>
      <div class="row">
        <% arrayAverage = function(arr) { return _.reduce(arr, (num1, num2) => {
        return num1 + num2; }, 0) / (arr.length === 0 ? 1 : arr.length); } %> <%
        for(var i = 0; i < data.length; i++) {%> <% var total =
        arrayAverage(data[i].ratingNumber) %>

        <div class="col-md-4">
          <a href="/company-profile/<%= data[i]._id %>" class="companyItem shadow-light">
            <% if (data[i].image) {%>
              <img
                src="/uploads/<%= data[i].image %>"
                class="companyImage"
                width="110px"
                width="110px"
              />
            <%} else {%>
              <img
                src="http://placehold.it/110x110"
                width="110px"
                height="110px"
                alt="Logo"
                class="companyImage"
              />
            <%}%>
            <div class="companyInfo">
              <h5 class="text my-1"><%= data[i].name %></h5>
              
              <i class="fa fa-building-o square"></i>
              <span class="subText"><%= data[i].sector %></span>
              <br />
              <i class="fa fa-map-marker square"></i>
              <span class="subText"><%= data[i].city %>, <%= data[i].country %></span>
              <br />
              <span class="">
                <i class="star" data-score="<%= total %>"></i>
                (<%= data[i].ratingNumber.length %>) 
              </span>
            </div>
          </a>
        </div>
        <% } %>
      </div>
    </div>
  </div>
</div>
